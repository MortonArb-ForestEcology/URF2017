species1 <-read.csv("data/TreeData-raw_data.csv", na.strings="")
species2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
species1 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings="")
species2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(species1)[6] <- "Species"
species1.data[,3] <- as.character(permtree.data[,3])
species2.data[,3] <- as.character(temptree.data[,3])
species <- rbind(species1[,c(3,6)], species2[,c(3,4)])
View(species)
species1.data[,3] <- as.character(species1[,3])
species2.data[,3] <- as.character(species2[,3])
species <- rbind(species1[,c(3,6)], species2[,c(3,4)])
View(species1)
View(species2)
setwd("~/GitHub/EastWoods-MonitoringPlots/TreeCensus_2017/")
oldplot.data <- read.csv("data/Old EW Survey Data/Old EW Plot Data.csv", na.strings="")
oldtree.data <- read.csv("data/Old EW Survey Data/Old EW Tree Data.csv", na.strings="")
tree.data <-read.csv("data/TreeData-raw_data.csv", na.strings="")
heights.data <- read.csv("data/TreeHeights-raw_data.csv", na.strings="")
plots1.data <- read.csv("data/CandidatePlots.csv", na.strings="")
library(car)
names(oldplot.data) <- c("Plot", "Shrub.Cover", "Shrub.Ht", "Herb.Cover", "Ground.Cover", "X", "Y", "Management.Unit",
"Burn.Year", "Thin.Year", "Notes")
oldplot.data <- oldplot.data[!is.na(oldplot.data[,1]),1:11]
oldtree.data <- oldtree.data[!is.na(oldtree.data[,1]),1:6]
names(oldtree.data)[1] <- "Plot"
tree.data$Sp_code <- as.factor(substr(tree.data$Sp_code, 1, 4))
oldtree.data$Species <- as.factor(substr(oldtree.data$Species, 1, 4))
oldtree.data$Species <- recode(oldtree.data$Species, " 'FR'='FRAM'; 'UL'='ULRU'; 'UL?'='ULRU'; 'QUEL'='QUAL'; 'ACNE' = 'ACNI' ")
tree.data$Canopy <- factor(tree.data$Canopy, levels=c("D", "CD", "I", "U", NA))
tree.data$Sp_code <- factor(tree.data$Sp_code,
levels=c("ACNI", "ACSA", "CACO", "CR", "FRAM", "JUNI", "OSVI", "POTR", "PRSE", "QUAL", "QUMA", "QURU", "TIAM", "ULRU", "UNKN", "unkn", NA))
oldtree.data$Species <-factor(oldtree.data$Species,
levels=c("ACNI", "ACSA", "CACO", "CR", "FRAM", "JUNI", "OSVI", "POTR", "PRSE", "QUAL", "QUMA", "QURU", "TIAM", "ULRU", "UNKN", "unkn", NA))
alltree.data <- merge(tree.data, heights.data[c(3,8)], by = "Tag")
alltree.data$BA <- pi*(alltree.data$DBH/200)^2 # Units = m2
plots.data <- plots1.data
plots.data$CORNER <- paste0(substr(plots1.data$CORNER, 1, nchar(paste(plots1.data$CORNER))-4), substr(plots1.data$CORNER, nchar(paste(plots1.data$CORNER))-2,nchar(paste(plots1.data$CORNER))))
plot.list <- c("N115", "U134", "HH115", "B127")
oldtree.data.subset <- oldtree.data[oldtree.data$Plot %in% unique(plots.data$CORNER),]
stand.data <- plots.data[3:4]
names(stand.data)[1] <- "Plot"
names(stand.data)[2] <- "Stand"
oldba.data <- aggregate(as.numeric(as.character(oldtree.data[,"BA"])),
oldtree.data[,c("Plot", "Species")],
sum)
oldba.data.subset <- aggregate(as.numeric(as.character(oldtree.data.subset[,"BA"])),
oldtree.data.subset[,c("Plot", "Species")],
sum)
newba.data <- aggregate(as.numeric(as.character(alltree.data[,"BA"])),
alltree.data[,c("Plot", "Sp_code")],
sum)
names(oldba.data)[3] <- "BA.tot"
names(oldba.data.subset)[3] <- "BA.tot"
names(newba.data)[3] <- "BA.tot"
oldba.data$Density <- oldba.data$BA.tot/250 # Units m2/ha
oldba.data.subset$Density <- oldba.data.subset$BA.tot/250 # Units m2/ha
newba.data$Density <- newba.data$BA.tot/400 # Units m2/ha
olddensity.data <- aggregate(oldtree.data[,"BA"],
oldtree.data[,c("Plot", "Species")],
length)
olddensity.data.subset <- aggregate(oldtree.data.subset[,"BA"],
oldtree.data.subset[,c("Plot", "Species")],
length)
newdensity.data <- aggregate(tree.data["DBH"],
tree.data[,c("Plot", "Sp_code")],
length)
names(olddensity.data)[3] <- "Stem.count"
names(olddensity.data.subset)[3] <- "Stem.count"
names(newdensity.data)[3] <- "Stem.count"
newba.data$Plot <- recode(newba.data$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
newdensity.data$Plot <- recode(newdensity.data$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
names(newba.data)[2] <- "Species"
names(newdensity.data)[2] <- "Species"
oldba.data.subset.stand <- merge(oldba.data.subset, stand.data, by = "Plot")
newba.data.stand <- merge(newba.data, stand.data, by = "Plot")
old.density <- merge(olddensity.data.subset, stand.data, by = "Plot")
new.density <- merge(newdensity.data, stand.data, by = "Plot")
newba.data.stand$Year <- 2017
oldba.data.subset.stand$Year <- 2011
old.density$Year <- 2011
new.density$Year <- 2017
ba.all <- rbind(newba.data.stand, oldba.data.subset.stand)
density.all <- rbind(old.density, new.density)
View(density.all)
alltree.data
View(alltree.data)
species <- rbind(species1[,c(2,3,6)], species2[,c(1,2,3,4)])
species <- rbind(species1[,c(2,3,6)], species2[,c(2,3,4)])
View(species)
names(species1)[6] <- "Species"
species1 <- recode(species1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
species1.data[,3] <- as.character(species1[,3])
species2.data[,3] <- as.character(species2[,3])
species <- rbind(species1[,c(2,3,6)], species2[,c(2,3,4)])
species1 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings="")
species2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(species1)[6] <- "Species"
species1 <- recode(species1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
species1.data[,3] <- as.character(species1[,3])
species1 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings="")
species2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(species1)[6] <- "Species"
species1$Plot <- recode(species1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
species1.data[,3] <- as.character(species1[,3])
species2.data[,3] <- as.character(species2[,3])
species <- rbind(species1[,c(2,3,6)], species2[,c(2,3,4)])
names(species1)[6] <- "Species"
species1$Plot <- recode(species1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
species1[,3] <- as.character(species1[,3])
species2[,3] <- as.character(species2[,3])
species <- rbind(species1[,c(2,3,6)], species2[,c(2,3,4)])
View(species)
library(dplR)
setwd("~/Github/URF2017/")
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/*.rwl')
permtree.data <-read.csv(file = "~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings = "", colClasses=c("Tag"="character"))
temptree.data <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(permtree.data)[6] <- "Species"
permtree.data[,3] <- as.character(permtree.data[,3])
temptree.data[,3] <- as.character(temptree.data[,3])
tree.species <- rbind(permtree.data[,c(3,6)], temptree.data[,c(3,4)])
tree.species$Species <- as.factor(substr(tree.species$Species, 1, 2))
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
files.all <- read.rwl(file.path(tr.path, rw.names[1]))
aa <- trw.names.split[[1]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(files.all) <- nam
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
aa <- trw.names.split[[i]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(file.tmp) <- nam
# Appending each file to the master list
files.all <- combine.rwl(files.all, file.tmp)
}
write.rwl(files.all, "oaks_master_trw.rwl", long.names=TRUE)
library(dplR)
package.install(dplR)
install.package(dplR)
install?
?install
install.packages(dplR)
install.packages("dplR")
library(dplR)
setwd("~/Github/URF2017/")
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/*.rwl')
permtree.data <-read.csv(file = "~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings = "", colClasses=c("Tag"="character"))
temptree.data <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(permtree.data)[6] <- "Species"
permtree.data[,3] <- as.character(permtree.data[,3])
temptree.data[,3] <- as.character(temptree.data[,3])
tree.species <- rbind(permtree.data[,c(3,6)], temptree.data[,c(3,4)])
tree.species$Species <- as.factor(substr(tree.species$Species, 1, 2))
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
files.all <- read.rwl(file.path(tr.path, rw.names[1]))
aa <- trw.names.split[[1]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(files.all) <- nam
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
aa <- trw.names.split[[i]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(file.tmp) <- nam
# Appending each file to the master list
files.all <- combine.rwl(files.all, file.tmp)
}
files.all
View(files.all)
survey1 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings="")
survey2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(survey1)[6] <- "Species"
survey1$Plot <- recode(survey1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
survey1[,3] <- as.character(survey1[,3])
survey2[,3] <- as.character(survey2[,3])
survey <- rbind(survey1[,c(2,3,6)], survey2[,c(2,3,4)])
i = trw.names[1]
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
i = trw.names[1]
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
trw.names[1]
(file.path(tr.path, trw.names[i])
)
file.path(tr.path, trw.names[i])
rw.names <- dir(tr.path)
rw.names
trw.names
file.path(tr.path, trw.names[i])
trw.names[i]
i = 1
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
file.tmp
names(file.tmp)
class(file.tmp)
data.frame(file.tmp)
names(file.temp) <- c("Year", "RingWidth")
names(file.tmp) <- c("Year", "RingWidth")
View(file.tmp)
View(file.tmp)
names(file.tmp) <- "RingWidth"
file.tmp$Tag <- "024"
file.tmp
temp <- merge(survey, file.tmp, "Tag")
temp
names(file.tmp)
rownames(file.tmp)
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
file.tmp$Tag <- "024"
file.tmp$Year <- rownames(file.tmp)
temp <- merge(survey, file.tmp, "Tag")
View(temp)
View(temp)
library(dplR)
library(car)
setwd("~/Github/URF2017/")
survey1 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings="")
survey2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(survey1)[6] <- "Species"
survey1$Plot <- recode(survey1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
survey1[,3] <- as.character(survey1[,3])
survey2[,3] <- as.character(survey2[,3])
survey <- rbind(survey1[,c(2,3,6)], survey2[,c(2,3,4)])
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/*.rwl')
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
file.tmp$Tag <- aa[3]
file.tmp$Year <- rownames(file.tmp)
data.all <- rbind(survey, file.tmp)
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
file.tmp <- read.rwl(file.path(tr.path, trw.names[1]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
file.tmp$Tag <- aa[3]
aa <- trw.names.split[[1]]
file.tmp$Tag <- aa[3]
file.tmp$Year <- rownames(file.tmp)
data.all <- rbind(survey, file.tmp)
rw.long <- read.rwl(file.path(tr.path, trw.names[1]))
data.frame(rw.long)
names(rw.long) <- "RingWidth"
aa <- trw.names.split[[1]]
rw.long$Tag <- aa[3]
rw.long$Year <- rownames(rw.long)
i=2
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
file.tmp$Tag <- aa[3]
file.tmp$Year <- rownames(file.tmp)
rw.long <- rbind(rw.long, file.tmp)
View(rw.long)
library(dplR)
library(car)
setwd("~/Github/URF2017/")
survey1 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings="")
survey2 <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(survey1)[6] <- "Species"
survey1$Plot <- recode(survey1$Plot, " 'A1'='N115'; 'B5'='U134'; 'C6'='HH115'; 'D1'='B127' ")
survey1[,3] <- as.character(survey1[,3])
survey2[,3] <- as.character(survey2[,3])
survey <- rbind(survey1[,c(2,3,6)], survey2[,c(2,3,4)])
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/*.rwl')
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
rw.long <- read.rwl(file.path(tr.path, trw.names[1]))
data.frame(rw.long)
names(rw.long) <- "RingWidth"
aa <- trw.names.split[[1]]
rw.long$Tag <- aa[3]
rw.long$Year <- rownames(rw.long)
i=2
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
View(file.tmp)
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
aa
rw.long <- read.rwl(file.path(tr.path, trw.names[1]))
data.frame(rw.long)
names(rw.long) <- "RingWidth"
aa <- trw.names.split[[1]]
rw.long$Tag <- paste(aa[c(3, 4, 6)], collapse="-")
rw.long$Year <- rownames(rw.long)
i=2
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
file.tmp$Tag <- paste(aa[c(3, 4, 6)], collapse="-")
file.tmp$Year <- rownames(file.tmp)
rw.long <- rbind(rw.long, file.tmp)
rownames(rw.long) <- c()
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
file.tmp$Tag <- paste(aa[c(3, 4, 6)], collapse="-")
file.tmp$Year <- rownames(file.tmp)
rw.long <- rbind(rw.long, file.tmp)
}
rw.long
rw.long <- read.rwl(file.path(tr.path, trw.names[1]))
data.frame(rw.long)
names(rw.long) <- "RingWidth"
aa <- trw.names.split[[1]]
rw.long$Tag <- aa[3]
rw.long$Core <- paste(aa[c(3, 4, 6)], collapse="-")
rw.long$Year <- rownames(rw.long)
rownames(rw.long) <- c()
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
data.frame(file.tmp)
names(file.tmp) <- "RingWidth"
aa <- trw.names.split[[i]]
file.tmp$Tag <- aa[3]
file.tmp$Core <- paste(aa[c(3, 4, 6)], collapse="-")
file.tmp$Year <- rownames(file.tmp)
rw.long <- rbind(rw.long, file.tmp)
}
data.all <- merge(survey, rw.long, "Tag")
survey
View(data.all)
# --------------------------------------
# Organizing and reformatting tree ring data
# Sierra Lopezalles, slopezal@caltech.edu
# July 27, 2017
# --------------------------------------
# --------------------------------------
library(dplR)
# Setting a working directory
setwd("~/Github/URF2017/")
# Pulling all raw tree ring files into one object
# CHANGE HERE IF USING ANOTHER FOLDER
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/Tilia/*.rwl')
# Grabbing all the species data
permtree.data <-read.csv(file = "~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings = "", colClasses=c("Tag"="character"))
temptree.data <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(permtree.data)[6] <- "Species"
permtree.data[,3] <- as.character(permtree.data[,3])
temptree.data[,3] <- as.character(temptree.data[,3])
tree.species <- rbind(permtree.data[,c(3,6)], temptree.data[,c(3,4)])
tree.species$Species <- as.factor(substr(tree.species$Species, 1, 2))
# Setting a path to the raw ring width folder
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/"
# Splitting the file name into lists
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
# --------------------------------------
# Combining and renaming ring width files
# --------------------------------------
# Initializing the master list with the first ring width set
# Reading in the first file
files.all <- read.rwl(file.path(tr.path, trw.names[1]))
# Storing the parts of the name
aa <- trw.names.split[[1]]
# Combining the parts of the name with species in the proper order
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
# Assigning the name to the file
names(files.all) <- nam
# Repeating for all other files
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
aa <- trw.names.split[[i]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(file.tmp) <- nam
# Appending each file to the master list
files.all <- combine.rwl(files.all, file.tmp)
}
# Exporting tree ring widths as one combined file
# CHECK NAME
write.rwl(files.all, "tilia_trw.rwl", long.names=TRUE)
# --------------------------------------
# Organizing and reformatting tree ring data
# Sierra Lopezalles, slopezal@caltech.edu
# July 27, 2017
# --------------------------------------
# --------------------------------------
library(dplR)
# Setting a working directory
setwd("~/Github/URF2017/")
# Pulling all raw tree ring files into one object
# CHANGE HERE IF USING ANOTHER FOLDER
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/Tilia/*.rwl')
# Grabbing all the species data
permtree.data <-read.csv(file = "~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings = "", colClasses=c("Tag"="character"))
temptree.data <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(permtree.data)[6] <- "Species"
permtree.data[,3] <- as.character(permtree.data[,3])
temptree.data[,3] <- as.character(temptree.data[,3])
tree.species <- rbind(permtree.data[,c(3,6)], temptree.data[,c(3,4)])
tree.species$Species <- as.factor(substr(tree.species$Species, 1, 2))
# Setting a path to the raw ring width folder
# CHECK NAME
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/Tilia"
# Splitting the file name into lists
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
# --------------------------------------
# Combining and renaming ring width files
# --------------------------------------
# Initializing the master list with the first ring width set
# Reading in the first file
files.all <- read.rwl(file.path(tr.path, trw.names[1]))
# Storing the parts of the name
aa <- trw.names.split[[1]]
# Combining the parts of the name with species in the proper order
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
# Assigning the name to the file
names(files.all) <- nam
# Repeating for all other files
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
aa <- trw.names.split[[i]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(file.tmp) <- nam
# Appending each file to the master list
files.all <- combine.rwl(files.all, file.tmp)
}
# Exporting tree ring widths as one combined file
# CHECK NAME
write.rwl(files.all, "tilia_trw.rwl", long.names=TRUE)
View(files.all)
write.rwl(files.all, "tilia_trw.rwl", long.names=TRUE)
write.rwl(files.all, "tilia_trw.rwl", long.names=TRUE)
library(dplR)
setwd("~/Github/URF2017/")
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/Tilia/*.rwl')
permtree.data <-read.csv(file = "~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings = "", colClasses=c("Tag"="character"))
temptree.data <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(permtree.data)[6] <- "Species"
permtree.data[,3] <- as.character(permtree.data[,3])
temptree.data[,3] <- as.character(temptree.data[,3])
tree.species <- rbind(permtree.data[,c(3,6)], temptree.data[,c(3,4)])
tree.species$Species <- as.factor(substr(tree.species$Species, 1, 2))
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/Tilia"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
files.all <- read.rwl(file.path(tr.path, trw.names[1]))
aa <- trw.names.split[[1]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(files.all) <- nam
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
aa <- trw.names.split[[i]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(file.tmp) <- nam
# Appending each file to the master list
files.all <- combine.rwl(files.all, file.tmp)
}
View(files.all)
write.rwl(files.all, "tilia2_trw.rwl", long.names=TRUE)
library(dplR)
setwd("~/Github/URF2017/")
rawringfiles <- Sys.glob('~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths/*.rwl')
permtree.data <-read.csv(file = "~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/TreeData-raw_data.csv", na.strings = "", colClasses=c("Tag"="character"))
temptree.data <-read.csv("~/Github/EastWoods-MonitoringPlots/TreeCensus_2017/data/URF_2017_AdditionalOakData-raw_data.csv", na.strings="", colClasses=c("Tag"="character"))
names(permtree.data)[6] <- "Species"
permtree.data[,3] <- as.character(permtree.data[,3])
temptree.data[,3] <- as.character(temptree.data[,3])
tree.species <- rbind(permtree.data[,c(3,6)], temptree.data[,c(3,4)])
tree.species$Species <- as.factor(substr(tree.species$Species, 1, 2))
tr.path <- "~/Google Drive/Morton Summer 2017/East Woods/Rollinson_Monitoring/Data/Tree Cores/RawRingWidths"
rw.names <- dir(tr.path)
trw.names <- rw.names[grep('ring width', rw.names)]
trw.names.split <- strsplit(trw.names, "-")
files.all <- read.rwl(file.path(tr.path, trw.names[1]))
aa <- trw.names.split[[1]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(files.all) <- nam
for(i in 2:length(trw.names)){
file.tmp <- read.rwl(file.path(tr.path, trw.names[i]))
aa <- trw.names.split[[i]]
nam <- paste0(as.character(tree.species[tree.species$Tag==aa[3],2]), paste(aa[c(3, 4, 6)], collapse=""))
names(file.tmp) <- nam
# Appending each file to the master list
files.all <- combine.rwl(files.all, file.tmp)
}
write.rwl(files.all, "oaks2_master_trw.rwl", long.names=TRUE)
View(files.all)
